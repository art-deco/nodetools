<!doctype html>
<html class="no-js b-Op" lang="en">
  <head>
    <meta charset="utf-8">
    <title>TrapCSS: NodeTools Tutorial</title>
    <meta
      content="A use case of using NodeTools stack to upgrade an existing Node.JS package called DropCSS into a library and binary compiled with Closure Compiler." name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link sizes="57x57" rel="apple-touch-icon" href="/nodetools/img/fav-57.png">
    <link sizes="76x76" rel="apple-touch-icon" href="/nodetools/img/fav-76.png">
    <link sizes="120x120" rel="apple-touch-icon" href="/nodetools/img/fav-120.png">
    <link sizes="152x152" rel="apple-touch-icon" href="/nodetools/img/fav-152.png">
    <link sizes="167x167" rel="apple-touch-icon" href="/nodetools/img/fav-167.png">
    <link sizes="180x180" rel="apple-touch-icon" href="/nodetools/img/fav-180.png">
    <link sizes="192x192" rel="icon" href="/nodetools/img/fav-192.png">
    <link sizes="128x128" rel="icon" href="/nodetools/img/fav-128.png">
    <link sizes="32x32" rel="icon" href="/nodetools/img/fav-32.png">
    <link
      href="https://fonts.googleapis.com/css?display=swap&amp;family=Ruda%3A400%2C700%7CMr%20De%20Haviland" rel="preload" as="fetch" crossOrigin>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossOrigin>
    <link href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700" rel="preload"
      as="style">
    <script>
      (function(b){var a=document.createElement("link");a.href=b;a.rel="stylesheet";a.crossOrigin="crossorigin";document.head.appendChild(a)})('https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700')
    </script>
    <style id="cpt">
      
        h1 { font-family: 'Mr De Haviland' }
    
      @font-face {
        font-family: 'Mr De Haviland';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Mr De Haviland Regular'), local('MrDeHaviland-Regular'), url('data:application/font-woff2;base64,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') format('woff2');
      }
      
    </style>
    <script>
      (function(){var b=/url\('([\s\S]+?)'\)/.exec(document.head.querySelector("#cpt").textContent);if(b){var a=document.createElement("link");a.rel="preload";a.as="font";a.href=b[1];document.head.appendChild(a)}})()
    </script>
    <script>(function(h,r){var a=Object.keys(h),c=!0;"CSS"in window&&"supports"in CSS?(a=a.reduce(function(k,b){var l=h[b];b=b.split("|");for(var m=!1,d={},f=0;f<b.length;d={a:d.a},f++)if(d.a=b[f],l.map(function(n){return function(e){e=e.split("|");for(var p=!1,g=0;g<e.length;g++){var q=e[g];if(CSS.supports(n.a,q)){p=!0;break}else k.push(n.a+": "+q)}return p}}(d)).filter(Boolean).length==l.length){m=!0;break}m||(c=!1);return k},[]),a.length?c&&console.log("\ud83d\udcbf Browser does not support CSS properties: %s",
a.join("\n "),"but supports alternatives."):console.log("\ud83d\udcbd Browser supports all modern CSS properties.")):(c=!1,console.log("\ud83d\udce0 Browser does not support CSS checks."));c||(a=document.createElement("link"),a.rel="stylesheet",a.href=r,document.head.appendChild(a))})({"align-self":["center"],"flex-grow|-ms-flex-positive":["1"],"flex|-ms-flex":["0 0 25%"],"display":["flex|-ms-flexbox"],"box-sizing":["border-box"],"order|-ms-flex-order":["1"],"flex-direction|-ms-flex-direction":["column"],"border-radius":[".25rem"],"box-shadow":["none"],"flex-basis|-ms-flex-preferred-size":["0"],"hyphens|-webkit-hyphens|-ms-hyphens":["auto"],"justify-content":["center"],"flex-wrap|-ms-flex-wrap":["wrap"],"flex-shrink|-ms-flex-negative":["0"],"position":["sticky|-webkit-sticky"],"align-items":["center"]}, '/nodetools/css/combined-prefixes.css')</script>
    <script>
      (function(q,k){function x(a){for(var f=/url\((.+?)\).*?;\s+unicode-range: (.+?);/g,b={},d=[],h;h=f.exec(a);){var r=h[2];d.push({url:h[1],a:r});b[r]=1}b=Object.keys(b).reduce(function(c,e){var g=e.split(/,\s/).map(function(l){return l.replace("U+","\\u").replace("-","-\\u")}).join("").toLowerCase();c[e]=new RegExp("["+g+"]");return c},{});var t=document.body?document.body.textContent:"",y=t?Object.keys(b).reduce(function(c,e){b[e].test(t)&&(c[e]=!0);return c},{}):Object.keys(b).reduce(function(c,
      e){e in k&&(c[e]=!0);return c},{});m=d.filter(function(c){return c.a in y}).map(function(c){return c.url});if(!m.length)return u();var v=document.createDocumentFragment();m.forEach(function(c,e){var g=document.createElement("link");g.href=c;g.rel="preload";g.as="font";var l=e+1;;g.onload=function(){return u(l)};g.setAttribute("crossorigin",!0);v.appendChild(g)});document.head.appendChild(v)}k=void 0===k?{}:k;var n=document.createElement("link");if(function(a,
      f){if(!a||!a.supports)return!1;try{return a.supports(f)}catch(b){return!1}}(n.relList,"preload")){var z=function(a,f,b){b=void 0===b?"":b;;var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&(200==d.status?(f(d.responseText)):console.error("Error loading webfont: server responded with code %s at %s",d.status,a))};d.open("GET",a);try{d.send(null)}catch(h){console.error(h)}};
      ;var p;(function(a,f){z(a.href,function(b){p=b;x(p)},"-"+(void 0===f?"link":f))})({href:q},"js");var m=[],w=0,u=function(a){w++;w>=m.length&&(a=document.createElement("style"),a.innerHTML=p,document.head.appendChild(a))}}else n.rel="stylesheet",n.href=q,document.head.appendChild(n)})('https://fonts.googleapis.com/css?display=swap&family=Ruda%3A400%2C700%7CMr%20De%20Haviland', {"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD":true})
    </script>
    <link rel="stylesheet" href="/nodetools/css/combined.css">
    <link rel="preload" as="style" href="/nodetools/highlight.js/styles/default.css">
    <style>
      .no-js [data-io], .no-js .ImageHolder, .no-js [data-loading] { display: none!important }
      .List {
                          font-size:small;
                        }
                        .List > a {
                          display: block!important;
                        }
    </style>
    <noscript>
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?display=swap&amp;family=Mr%20De%20Haviland&amp;text=TrapCSS%3A%20NodeTools%20Tutorial">
      <link rel="stylesheet" href="/nodetools/css/combined-prefixes.css">
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?display=swap&amp;family=Ruda%3A400%2C700%7CMr%20De%20Haviland">
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700">
    </noscript>
    <script defer src="/nodetools/js/polyfill/intersection-observer.js"></script>
    <script defer src="/nodetools/js/images.js"></script>
    <script crossorigin data-src="/nodetools/preact/dist/preact.min.js"></script>
    <script crossorigin data-src="/nodetools/comps/common.js"></script>
    <script crossorigin data-src="/nodetools/comps/trapcss.js"></script>
    <script>
      document.documentElement.classList.remove("no-js")
    </script>
  </head>
  <body class="b-Mk b-Ol b-Op">
    
    <main class="b-Xl" role="main">
      <div class="b-z">
        <div class="b-B">
          <div class="left-column b-hb">
            <div class="b-kC">
            
                <img class="ImageHolder b-t b-vk" sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px" alt="@artdeco/nodetools logo" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='600' height='400'/%3E">
                <noscript>
                  <picture>
                    <source srcset="/nodetools/img/splash-576.webp 576w,/nodetools/img/splash-319.webp 319w,/nodetools/img/splash-600.webp 600w"
                      sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px" type="image/webp">
                    <img class="b-t b-vk" onLoad="webploaded(this)" alt="@artdeco/nodetools logo" src="/nodetools/img/splash-576.jpg" srcset="/nodetools/img/splash-576.jpg 576w,/nodetools/img/splash-319.jpg 319w,/nodetools/img/splash-600.jpg 600w" sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px">
                  </picture>
                </noscript>
              </div>
              <div class="b-kC">
                <a title="The NodeTools Stack Website." class="GitHubBadge" id="cacd9"
                  href="https://github.com/art-deco/nodetools">
                  <span class="a">GitHub</span><span class="b" data-stargazers>⭐️ 1</span></a>
                
                
                
              </div>
              <h3 id="pages">Pages</h3>
              <ul>
                <li class><a data-file="index" href="/nodetools/">NodeTools: Node.JS Stack</a></li>
                <li class>
                  <a data-file="quick-start" href="/nodetools/quick-start-to-nodetools.html">Quick Start To NodeTools</a>
                </li>
                <li class="Active">
                  <a data-file="trapcss" href="/nodetools/trapcss-nodetools-tutorial.html">TrapCSS: NodeTools Tutorial</a>
                </li>
                <li class>
                  <a data-file="babel" href="/nodetools/babel-when-open-source-is-not-free-sofware.html">
                    Babel: When Open Source Is Not Free Sofware</a>
                </li>
                <li class>
                  <a data-file="discussion" href="/nodetools/discussion-for-nodetools.html">Discussion for NodeTools</a>
                </li>
              </ul>
              <h3 id="stack">Stack</h3>
              <div class="List b-xq b-kC">
                <a
                  title="Create Packages From GitHub Templates. My New Package is an installer of new packages via GitHub templates: create a template and add an automated script to CLI questions, update files, access GitHub API and spawn commands during generation." class="NPMBadge" href="https://www.npmjs.com/package/mnp">
                  <span class="a"><em>MNP</em></span><span class="b">1.1.0</span></a>
                <a
                  title="Organises TypeDefs By Placing Them Into Types.Xml File To Be Embedded Into Source Code Compatible With VSCode And Google Closure Compiler, Generates Externs And Allows To Place Documentation In README Markdown." class="NPMBadge" href="https://www.npmjs.com/package/typal">
                  <span class="a"><em>Typal</em></span><span class="b">1.26.0</span></a>
                <a
                  title="Proper Node.JS Package Compiler (And Front-End Code Bundler) With Closure Compiler. Can create a single executable JS file and merge and optimise all dependencies." class="NPMBadge" href="https://www.npmjs.com/package/depack">
                  <span class="a"><em>Depack</em></span><span class="b">1.1.0</span></a>
                <a
                  title="A Regex-Based Transpiler Of Source Code To Allow Writing Import And Export Statements And JSX With 0 Dependencies." class="NPMBadge" href="https://www.npmjs.com/package/alamode">
                  <span class="a"><em>ÀLaMode</em></span><span class="b">3.3.1</span></a>
                <a
                  title="The 2019 Most Modern Testing Framework For Node.JS With Test Contexts (Reusable BeforeEach / AfterEach Via Separate Files); Masks (Inputs/Outputs In Non-Js Files) And Fork Testing; Interactive Snapshots." class="NPMBadge" href="https://www.npmjs.com/package/zoroaster">
                  <span class="a"><em>Zoroaster</em></span><span class="b">4.1.2</span></a>
                <a
                  title="Documentation Compiler To Generate The Table Of Contents, Embed Examples With Their Output, Make Markdown Tables, Maintain Typedefs For JavaScript And README, Watch Changes To Push, Use Macros And Prettify API Titles." class="NPMBadge" href="https://www.npmjs.com/package/documentary">
                  <span class="a"><em>Documentary</em></span><span class="b">1.35.9</span></a>
              </div>
              <h3 id="web-software">Web Software</h3>
              <div class="List b-xq b-kC">
                <a
                  title="2-Dependency Koa Web Server Compiled With Closure Compiler And Bundled With Essential Middleware: Static, Compress, Session, Cors, File Upload, Router And JSX Front End." class="NPMBadge" href="https://www.npmjs.com/package/@idio/idio">
                  <span class="a"><em>Idio</em></span><span class="b">1.2.3</span></a>
                <a
                  title="Static Web Site Compiler That Uses Closure Compiler For JS Bundling And Closure Stylesheets For CSS optimisations. Supports JSX Syntax To Write Static Elements And Dynamic Preact Components." class="NPMBadge" href="https://www.npmjs.com/package/splendid">
                  <span class="a"><em>Splendid</em></span><span class="b">1.16.13</span></a>
              </div>
              <h3 id="misc">Misc</h3>
              <ul>
                <li><a href="https://gitter.im/node_tools/community">Get Help In Gitter Chat</a></li>
                <li><a href="https://opencollective.com/nodetools">Fund Us On Open Collective</a></li>
              </ul>
              <div class="SideBarMenu sidebarshowing b-jr b-zp">
                <div class="a">
                  
                                  <h3 id="-on-this-page"> On This Page</h3>
                                  <ul id="OnThisPage">
                                    <li data-heading="trapcss"><a href="#trapcss">TrapCSS</a></li>
                                    <li data-heading="mnp"><a href="#mnp">MNP</a></li>
                                    <li data-heading="upgrading-source-code"><a href="#upgrading-source-code">Upgrading Source Code</a></li>
                                    <li data-heading="adding-types"><a href="#adding-types">Adding Types</a></li>
                                    <li data-heading="initial-documentation"><a href="#initial-documentation">Initial Documentation</a></li>
                                    <li data-heading="creating-tests"><a href="#creating-tests">Creating Tests</a></li>
                                  </ul>
                                  <h3 id="share-nodetools">Share NodeTools</h3>
                                  <span class="b-xq b-Hk" id="c485b"><span class="b-Hk" style="height:32px" data-loading>Loading sharing buttons...</span><noscript>Please enable JavaScript to Share</noscript></span>
                                  
                                  <div class="b-xq" id="updates-div">Loading web-push...</div>
                                  <details id="NewsletterDetails">
                                    <summary>
                                      <h3 id="newsletter">Newsletter</h3>
                                    </summary>
                                    <div id="emails-div">Loading widget...</div>
                                  </details>
                                
                </div>
                <a id="HideMenu" style="color:grey!important;" href="#">hide menu</a>
                <a id="ShowMenu" style="color:grey!important;" href="#">show menu</a>
              </div>
          </div>
          
          <div class="right-column b-xq b-nb" id="Content">
            
            
            <div data-section id="trapcss">
            <h1 id="trapcss-nodetools-tutorial">TrapCSS: NodeTools Tutorial</h1>
            
            
            
            <p>There are CSS frameworks such as <em>Bootstrap</em> that allow to create great layouts quickly, however their size might be quite large. This point is worth considering because CSS is loaded in a blocking fashion: the browser will have to wait before all CSS is loaded to render a web site, which slows page render, and affects usability and even search engine ranking negatively. In many cases, a lot of CSS can be "dropped" from frameworks' compiled code, and by leaving only those selectors that are present on a page, or multiple pages. This technique corresponds to the "Defer unused CSS" Lighthouse <a href="https://developers.google.com/web/tools/lighthouse/audits/unused-css">warning</a>.</p>
            
            <p>
              <img class="ImageHolder b-vk b-t" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px" alt="trap css nodetools tutorial" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='674'/%3E">
              <noscript>
                <picture>
                  <source
                    srcset="/nodetools/pages/trapcss/img/splash-768.webp 768w,/nodetools/pages/trapcss/img/splash-576.webp 576w,/nodetools/pages/trapcss/img/splash-319.webp 319w,/nodetools/pages/trapcss/img/splash-1000.webp 1000w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px"
                    type="image/webp">
                  <img class="b-vk b-t" onLoad="webploaded(this)" alt="trap css nodetools tutorial" src="/nodetools/pages/trapcss/img/splash-768.jpg" srcset="/nodetools/pages/trapcss/img/splash-768.jpg 768w,/nodetools/pages/trapcss/img/splash-576.jpg 576w,/nodetools/pages/trapcss/img/splash-319.jpg 319w,/nodetools/pages/trapcss/img/splash-1000.jpg 1000w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px">
                </picture>
              </noscript>
            </p>
            
            <p>One of the packages that is able to do it quickly is called <a href="https://github.com/leeoniya/dropcss">DropCSS</a>, developed by <a href="https://github.com/leeoniya">Leon Sorokin</a>. It's notable for its speed, simplicity and the amount of bytes that can shaved off the CSS. However, for our use case it was not perfect: it strips comments and does not allow to keep arbitrary annotations, such as <span class="tm">/* alternate */</span> which is needed for <a href="https://github.com/artdecocode/closure-stylesheets-java">Closure Stylesheets</a>. Closure Stylesheets is an optimiser of CSS that can minify and put styles together. Art Deco uses it for Splendid, a static website generator. By collecting selectors across all pages on a generated website, we're able to drop unused Bootstrap rules, and then merge Bootstrap with other styles so that a single, small CSS file is served to visitors quickly.</p>
            
            <p>But Bootstrap contains rules that repeat the CSS properties, e.g.,:</p>
            
            <pre id="c1d47"><code class="css hljs">abbr[title],
abbr[data-original-title] {
  text-decoration: underline;
  -webkit-text-decoration: underline dotted;
  /* @alternate */
  text-decoration: underline dotted;
  /* ^ repeated use, need alternate */
}</code></pre>
            
            <p>We needed to annotate Bootstrap with the <span class="tm">/* alternate */</span> marker so that the CSS compiler doesn't throw an error. A simple proposed solution to prevent stripping such comments was suggested in form of a <a href="https://github.com/leeoniya/dropcss/pull/41">PR</a> to <em>DropCSS</em> package owner, however was rejected as being too narrow of a use case. Therefore, we decided to fork his project and use its source code to create a professional Node.JS package that would also provide JSDoc annotations, could be tested with context testing, and is ready to be compiled into other packages, such as <em>Splendid</em> itself, so that it's linked statically instead of dynamically as permitted by the original MIT license.</p>
            
            <p>This tutorial walks through the process of upgrading a package to use <em>NodeTools</em> stack with explanation of advantages of using the tools from the stack in creating modern packages. You might want to read the <a href="/nodetools/quick-start-to-nodetools.html">quick start</a> guide first for some details about the standard routine.</p>
            
            <strong>TrapCSS</strong> on <em>GitHub</em>: <a
               title="Removes unused selectors from CSS files to achieve maximum optimisation. Can be used as an API function or with CLI." class="GitHubBadge" id="c1dbc" href="https://github.com/artdecocode/trapcss">
               <span class="a">GitHub</span><span class="b" data-stargazers>⭐️ 1</span></a>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='15'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/0.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="mnp">
            <h2 id="mnp">MNP</h2>
            
            <p>The very first step is to spawn a new package using <span class="tm">mnp</span> binary. Instead of forking the repo, I will create a new package so that its structure adheres to <em>NodeTools</em>' recommendations. My default organisation is <span class="tm">artdecocode</span> on <em>GitHub</em> and I keep projects in the <strong>~/adc</strong> folder. Additionally, I've made a number of other orgs, such as <span class="tm2">dpck</span>, <span class="tm2">a-la</span> for scopes of other projects that are made up of many packages &mdash; organising your <em>GitHub</em> workspace and the home dir by orgs is a convenient method that allows to maintain different settings for different organisations and keep them semantically grouped. When you're ready to grant permissions to other developers to maintain your packages, you can do it on per-org basis. For a standard <em>Node.JS</em> package, I'll just use <span class="tm">adc</span>.</p>
            
            <pre id="c414d"><code class="bash hljs">cd adc
# mnp --init (if init was not done yet)
mnp trapcss -n</code></pre>
            
            <p>I've already <a href="/nodetools/quick-start-to-nodetools.html#configure-org">configured mnp</a> prior to creating a package, therefore all settings are already recorded in the <span class="tm">.mnprc</span> file. I pass the package name to the binary, together with the <span class="tm">-n</span> flag, which means <span class="tm">--no-scope</span>: because settings contain a scope (<span class="tm">@artdeco</span>), I want to skip it in this particular case. <em>MNP</em> then asks me questions about the new package:</p>
            
            <pre id="c414d1"><code class="bash hljs"># trapcss
Description: Removes unused selectors from CSS files to achieve maximum optimisation. Can be used as an API function or with CLI.
Generating repository...
Starring...
⭐️ Created and starred a new repository
https://github.com/artdecocode/trapcss
Cloning into '/Users/zavr/adc/trapcss'...
Setting user Anton&lt;anton@adc.sh&gt;...
With binary [y/n]: [y]
Build or compile: [compile]
License: [agpl-3.0]
Init Github Wiki [y/n]: [y]
Homepage: [https://github.com/artdecocode/trapcss#readme] https://art-deco.github.io/trapcss
Keywords (e.g., artdecocode, trapcss): css, minifier, web, browser
Please go to https://github.com/artdecocode/trapcss/wiki/_new
to create the first page and press enter when done. (y/n): [y]
Cloning into '/Users/zavr/adc/trapcss/wiki.git'...
Setting topics...
Initialised package structure, pushing...
yarn install v1.13.0
✨  Done in 2.67s.
Created a new package: trapcss.</code></pre>
            
            <p>I've answered questions in the following way:</p>
            
            <ul>
              <li>With binary: <strong>true</strong>, because I'll want to create a node executable to run from the CLI to drop selectors from CSS files based on HTML files.</li>
              <li>Build or compile: <strong>compile</strong>, because I want to create a library compatible with Closure so that it can be compiled into <em>Splendid</em> later.</li>
              <li>License: <strong>agpl-3.0</strong>, my personal preference that prevents exploitation of my work. We'll keep the original MIT copyright notice in the source code.</li>
              <li>Init Github Wiki: <strong>y</strong>, we'll want to create wiki pages with discussion about certain use cases, such as using multiple HTML files to gather selectors list.</li>
              <li>Homepage: <strong>https://art-deco.github.io/trapcss</strong>, I update the default homepage that points to the repo readme on GitHub, because I'll want to create a website for the package with a demo.</li>
              <li>Keywords: <strong>css, minifier, web, browser</strong>, some tags for GitHub topics and NPM keywords.</li>
            </ul>
            
            <p>I'm then asked to navigate to GitHub to create the first Home wiki page. This needs to be done manually since GitHub does not provide API routes for automation of this procedure. Moreover, because I've configured <em>MNP</em> to use <strong>yarn</strong> as the package manager, the dependencies are also installed automatically. The template also supports <span class="tm">npm</span> with <strong>package-lock.json</strong> file instead of <strong>yarn.lock</strong>. After this is done, the repo is cloned into a local working dir, called <span class="tm">trapcss</span> and <em>MNP</em> opens <em>VSCode</em> automatically. A new tag <span class="tm">v0.0.0-pre</span> is added to the git tree at this point.</p>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='13'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/1.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="upgrading-source-code">
            <h2 id="upgrading-source-code">Upgrading Source Code</h2>
            
            <p>As the next step, I'll just download the ZIP archive from <em>DropCSS</em> with the source code, and open finder to copy all files from source into <strong>m</strong>y <strong>n</strong>ew <strong>p</strong>ackage.</p>
            
            <p>The original source is using <em>CommonJS</em> however <em>NodeTools</em> allow to program using ECMA modules with a 0-dependency regex transpiler, so we want to update the source code from <span class="tm">require</span> into imports.</p>
            
            <pre id="ccdbf"><code class="javascript hljs">"use strict";

const { parse: parseHTML } = require('./html');
const { parse: parseCSS, generate: generateCSS,
  SELECTORS, stripEmptyAts } = require('./css');
const { some, matchesAttr } = require('./find');
const { postProc } = require('./postproc');
const { LOGGING } = require('./env');</code></pre>
            
            <p>This can be achieved easily by running the transpiler in <span class="tm">-r</span> mode:</p>
            
            <pre id="c724c"><code class="shell hljs">MacBook:trapcss zavr$ yarn alamode src -r</code></pre>
            
            <p>It will scan the <strong>src</strong> dir recursively, updating all files in there. By using <span class="Manager" id="cbabb">yarn bin-alias</span> I can execute binaries from node_modules installed in the project folder.</p>
            
            <p>When trying to simply check that all imports are updated correctly by running <span class="Manager" id="c093b">yarn alanode src/dropcss</span> that only executes all require calls without actually running the program, I see an error to do with the following:</p>
            
            <pre id="ccdbf1"><code class="javascript hljs">// src/find.js
function some(nodes, m) {
  return nodes.some(node =&gt; find(m, {
    idx: m.length - 1,
    node
  }));
}

export { matchesAttr };

export const some = (nodes, sel) =&gt; {
  return some(nodes, Array.isArray(sel) ? sel : parseSel(sel));
};</code></pre>
            
            <p>The error says:</p>
            
            <pre id="c724c1"><code class="shell hljs">MacBook:trapcss zavr$ yarn alanode src/dropcss.js
/Users/zavr/adc/trapcss/src/find.js:205
       const some = (nodes, sel) =&gt; {
             ^

SyntaxError: Identifier 'some' has already been declared</code></pre>
            
            <p>This is because after updating to imports, we acquired a name conflict. This is fixed simply by renaming the original function into <span class="tm">_some</span> and calling it from the export:</p>
            
            <pre id="ccdbf2"><code class="javascript hljs">// src/find.js
function _some(nodes, m) {
  // ...
}

export const some = (nodes, sel) =&gt; {
  return _some(nodes, Array.isArray(sel) ? sel : parseSel(sel));
};</code></pre>
            
            <p>In addition, I don't use semicolons therefore I'll quickly fix that with <em>ESLint</em>. <em>ESLint</em> should be installed globally on the system since it's a huge binary and there's no point in installing it for each single package. If you have your own eslint config, you need to fork the template from <span class="tm">mnpjs/package</span>, define your config in there, and modify the <span class="tm">.mnprc</span> settings file to point to your forked template.</p>
            
            <pre id="c724c2"><code class="shell hljs">MacBook:trapcss zavr$ eslint --fix src</code></pre>
            
            <p>As the last step for styling, I want to get rid of all <span class="tm">&quot;use strict&quot;</span> directives on top of each file, by a simple search and replace in <em>VSCode</em>: <span class="tm">&quot;use strict&quot;\n\n</span> -> "". Finally, I want the entry to the library be located at <strong>src/index.js</strong> instead of <strong>src/dropcss.js</strong>, therefore I copy the typedef from <span class="tm">index.js</span>, delete the file, and rename <span class="tm">dropcss.js</span> into <span class="tm">index.js</span>.</p>
            
            <pre id="ccdbf3"><code class="javascript hljs">// copy typedef as needed for next step
/**
 * @suppress {nonStandardJsDocs}
 * @typedef {import('../types').trapcss} _trapcss.trapcss
 */</code></pre>
            
            <p>Now I can commit all new source code into the git tree, and start testing/documenting the library.</p>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='13'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/2.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="adding-types">
            <h2 id="adding-types">Adding Types</h2>
            
            <p>After we've copied the typedef, we'll want to write types that are relevant for our program. The main method accepts a hashmap config, so we'll document its structure in <span class="tm">types/index.xml</span>.</p>
            
            <pre id="c16f7"><code class="xml hljs">&lt;types namespace="_trapcss"&gt;
  &lt;record name="Config" desc="Options for the program."&gt;
    &lt;prop string name="html"&gt;
      The input HTML.
    &lt;/prop&gt;
    &lt;prop string name="css"&gt;
      The CSS to drop selectors from.
    &lt;/prop&gt;
    &lt;prop boolean name="keepAlternate" default="false"&gt;
      Whether to keep the `@alternate` comment for
      Closure Stylesheets.
    &lt;/prop&gt;
    &lt;fn name="shouldDrop" opt return="boolean"&gt;
      &lt;arg string name="sel"&gt;The selector to check.&lt;/arg&gt;
      Whether _TrapCSS_ should remove this selector.
      The `shouldDrop` hook is called for every CSS selector
      that could not be matched in the html. Return `false`
      to retain the selector or `true` to drop it.
    &lt;/fn&gt;
  &lt;/record&gt;

  &lt;type record name="Return" desc="Return Type."&gt;
    &lt;prop string name="css"&gt;
      The dropped CSS.
    &lt;/prop&gt;
    &lt;prop type="!Set&lt;string&gt;" name="sels"&gt;
      The used selectors.
    &lt;/prop&gt;
  &lt;/type&gt;
&lt;/types&gt;</code></pre>
            
            <p>We're using the <span class="tm">_trapcss</span> namespace to be able to name our config as <span class="tm">_trapcss.Config</span> and distinguish it from other packages' configs that can be defined with the same name. The namespace is the feature of <em>VSCode</em> that we use to our advantage, and it's not much different from standard typedefs, only that names of types are preceded with the <span class="tm">_ns</span>. We also use <span class="tm2">_</span> underscore as the convention for namespaces' titles, otherwise there might be conflicts between them and some functions in the source code.</p>
            
            <p>There are 3 main types of types: records, interfaces and constructors. The key point to remember is that records are used for configs and other simple objects passed between programs, while interfaces are used to describe methods and properties on classes, which are then annotated with <span class="tm">/* @implements {_ns.Type} */</span> in the source code. Unfortunately, <em>VSCode</em> doesn't understand the implements notation and will not allow to "put meat" or grow implementation on the interface defined like that while providing hints during implementation process, but this notation is used to enable Closure Compiler type checking. Some examples of <span class="tm">@implements</span> can be found in the <a
              href="https://github.com/idiocc/goa/blob/4b4534c304870ace80a42245ac0303f85b6eb6d3/src/application.js#L18">
              Goa server</a>.</p>
            
            <pre id="ccdbf4"><code class="javascript hljs">/**
 * @implements {_goa.Application}
 */
export default class Application extends EventEmitter {
  /**
   * Initialize a new `Application`.
   * @param {!_goa.ApplicationOptions} options
   */
  constructor(options = {}) {}
  // if VSCode understood @implements, we wouldn't have to
  // specify the type of the argument in @param as it could
  // be deducted from the interface type ;)
}</code></pre>
            
            <p>The <span class="tm">&lt;type record&gt;...&lt;/type&gt;</span> block can be simplified to <span class="tm">&lt;record&gt;...&lt;/record&gt;</span>, same with <em>interface</em>. Constructors are used very rarely.</p>
            
            <p>If a type is defined without record/interface attribute, it becomes the simplest type in the <em>Closure</em> type system called a <strong>structural interface</strong>, for example, <span class="tm">{ prop: string, prop2: (number|undefined) }</span>. An object like that is not nullable &mdash; since Closure tries to make JavaScript similar to Java, type nullability is a thing. More complex types, such as records and interfaces are nullable, whereas structural interfaces are not. Here's some more documentation on <a href="https://github.com/google/closure-compiler/wiki/Types-in-the-Closure-Type-System">types</a>. Therefore, when we use a record that is not expected to be nullable, we'll want to add <span class="tm">!</span> in front of it, as shown below.</p>
            
            <p>Not only do we document config and return types in XML, but also the actual API contract of the library, which is placed in the <strong>types/api.xml</strong> file and describes all available methods that can be imported from our Node.JS library.</p>
            
            <pre id="c16f71"><code class="xml hljs">&lt;types namespace="_trapcss"&gt;
  &lt;method name="trapcss" return="!_trapcss.Return"&gt;
    &lt;arg name="opts" type="!_trapcss.Config"&gt;
      The options for _TrapCSS_.
    &lt;/arg&gt;
    Parses the supplied HTML and CSS and removes
    unused selectors. Also removes empty CSS rules.
  &lt;/method&gt;
&lt;/types&gt;</code></pre>
            
            <p>It's the core principle of <em>NodeTools</em> to use XML to store types. You can view it as the design stage that provides a language- and tool-agnostic way to document our software, whereas JS is used for implementation later. We can reuse types for any purpose, such as creating documentation as shown later. Because types are not written in a complex proprietary format like .ts (TypeScript typings), anyone can make software that uses a simple XML parser to extract types, and build their own schema upon the existing one.</p>
            
            <p>The next thing we want to do is to generate typedefs for <em>VSCode</em> so that we can get working on the source code implementation. The template we used with <em>MNP</em> already has the set up ready for that, we just call <span class="Manager" id="c651c">yarn d</span>. This command will update typedefs in <span class="tm">types/index.js</span>, which are then imported in our source code. <span class="Manager" id="c651c1">yarn d</span> actually spawns multiple commands, including <span class="tm">template</span>, <span class="tm">d1</span> and <span class="tm">externs</span>. It will run <span class="tm">yarn-s</span> or <span class="tm">npm-s</span> for serial execution of those commands, but you might want to replace that to <span class="tm">npm-s</span>. We'll fix this in the next version of the template to accound</p>
            
            <pre id="ccdbf5"><code class="javascript hljs">export {}

/* typal types/api.xml namespace */
/**
 * @typedef {_trapcss.trapcss} trapcss Parses the supplied HTML and CSS and removes
unused selectors. Also removes empty CSS rules.
 * @typedef {(opts: _trapcss.Config) =&gt; _trapcss.Return} _trapcss.trapcss Parses the supplied HTML and CSS and removes
unused selectors. Also removes empty CSS rules.
 */

/**
 * @typedef {import('..').Config} _trapcss.Config
 */

 // 1) add the return import
/**
 * @typedef {import('..').Return} _trapcss.Return
 */</code></pre>
            
            <p>The config is imported from the main JS of the package, which is kept in <span class="tm">compile/index.js</span>. We'll come back to that later, but we also need to import <span class="tm2">(1)</span> the return type manually, as the template's function simply returned a string before. To check that it's been imported correctly, we simply hover over the top declaration.</p>
            
            <p>
              <img class="b-bk b-vk b-t" alt="trapcss api method type" data-io>
              <noscript>
                <img class="b-bk b-vk b-t" alt="trapcss api method type" src="/nodetools/pages/trapcss/img/trap.gif">
              </noscript>
            </p>
            
            <p>This <strong>types/index.js</strong> file is only used for development purposes, and it's real aim is to provide an annotated function type that is then imported in the source code. We come back to the source code, find our implementation and annotate it with the type:</p>
            
            <pre id="ccdbf6"><code class="javascript hljs">// src/index.js
// adding @type

/**
 * @type {_trapcss.trapcss}
 */
function dropcss(opts) {
  let log, START

  if (LOGGING) {
    START = +new Date()
    log = [[0, 'Start']]
  }
  // ... implementation
}</code></pre>
            
            <p>Make sure to remember to copy across that typedef with import:</p>
            
            <pre id="cb288"><code class="undefined hljs">/**
 * @suppress {nonStandardJsDocs}
 * @typedef {import('../types').trapcss} _trapcss.trapcss
 */</code></pre>
            
            <p>The <strong>@suppress</strong> is needed because Closure Compiler cannot parse imports in typedefs, so that we skip this warnings. However, this function type is also generated in externs which are fed to the Compiler when compiling packages, so that it will be aware of the type. When using namespaces, we need to be consistent with their namings: if we simply imported <span class="tm">trapcss</span> instead of <span class="tm">_trapcss.trapcss</span>, we'd receive access to <em>VSCode</em> <em>JSDoc</em>, but the compiler wouldn't know about the <span class="tm">trapcss</span> type without the namespace.</p>
            
            <p>
              <img class="b-bk b-vk b-t" alt="importing the trapcss method in implementation for @type annotation" data-io>
              <noscript>
                <img class="b-bk b-vk b-t" alt="importing the trapcss method in implementation for @type annotation" src="/nodetools/pages/trapcss/img/trap2.gif">
              </noscript>
            </p>
            
            <p>The advantage of such annotation is that the comments will be lost during compilation anyway, so we don't have to waste time maintaining them in the source code itself. If we need to update the API contract, we go to the XML file, make changes there, and generate new annotations and externs using <span class="Manager" id="c651c2">yarn d</span> command. The externs look like the following:</p>
            
            <pre id="ccdbf9"><code class="javascript hljs">/**
 * @fileoverview
 * @externs
 */

/* typal types/index.xml externs */
/** @const */
var _trapcss = {}
/**
 * Options for the program.
 * @record
 */
_trapcss.Config
/**
 * The input HTML.
 * @type {string}
 */
_trapcss.Config.prototype.html
/**
 * The CSS to drop selectors from.
 * @type {string}
 */
_trapcss.Config.prototype.css
/**
 * Whether to keep the `@alternate` comment for
 * Closure Stylesheets. Default `false`.
 * @type {boolean|undefined}
 */
_trapcss.Config.prototype.keepAlternate
/**
 * Whether _TrapCSS_ should remove this selector.
 * The `shouldDrop` hook is called for every CSS selector
 * that could not be matched in the html. Return `false`
 * to retain the selector or `true` to drop it.
 * @type {(function(string): boolean)|undefined}
 */
_trapcss.Config.prototype.shouldDrop = function(sel) {}
/**
 * Return Type.
 * @record
 */
_trapcss.Return
/**
 * The dropped CSS.
 * @type {string}
 */
_trapcss.Return.prototype.css
/**
 * The used selectors.
 * @type {!Set&lt;string&gt;}
 */
_trapcss.Return.prototype.sels

/* typal types/api.xml externs */
/**
 * Parses the supplied HTML and CSS and removes
unused selectors. Also removes empty CSS rules.
 * @typedef {function(_trapcss.Config): _trapcss.Return}
 */
_trapcss.trapcss
</code></pre>
            
            <p>The purpose of externs is to provide type information for Closure Compiler. When using advanced compilation, which we are, property names on objects will get renamed, which is not good when we publish the package with declared config type. By generating an extern, we're making sure that its properties are not renamed. <strong>package.json</strong> file also adds the <span class="tm">&quot;externs&quot;: &quot;types/externs.js&quot;</span> field, so that 3rd party packages that want to compile our package into themselves, will receive access to its types for <em>Closure</em>. This is how <em>NodeTools</em> infrastructure works.</p>
            
            <p>Our standard is to use destructuring on the config to extract its properties for use in the program first thing. If the config was not compulsory, we'd also add <span class="tm">function (config={})</span>, but it's not the case here. When doing this, we also receive the type of the property, so that we're able to receive hints if we need to perform operations on this new objects.</p>
            
            <p>
              <img class="b-bk b-vk b-t" alt="receiving access to property types" data-io>
              <noscript>
                <img class="b-bk b-vk b-t" alt="receiving access to property types" src="/nodetools/pages/trapcss/img/trap3.gif">
              </noscript>
            </p>
            
            <p>On the screenshot above, you can see how the IDE provides me with autocompletion hint when I'm trying to get access to the <span class="tm">.length</span> property, for example to check that HTML is not empty. This is essential for developer experience of the person who's coding the package, so by simply importing the type, we were able to achieve this productivity without full <em>JSDoc</em> with <span class="tm">@param {Object}</span> comments. Sadly, <em>VSCode</em> does not show the description of the property, otherwise it'd be really perfect, but maybe they can do it in the next version.</p>
            
            <p>So we just update the source code to pass destructured properties, and the new <span class="tm">keepAlternate</span> additional property to the <span class="tm2">parseCSS</span> method. The <span class="tm">keepText</span> second argument for <em>parseHTML</em> is not even accepted by this function, so we remove it.</p>
            
            <pre id="ccdbf7"><code class="javascript hljs">// const H = parseHTML(opts.html, !opts.keepText) =&gt;
   const H = parseHTML(html)

// const shouldDrop = opts.shouldDrop || drop =&gt;
// default is now assigned via destructuing
// above { shouldDrop = drop, ... } = opts

// let tokens = parseCSS(opts.css) =&gt;
   let tokens = parseCSS(css, keepAlternate)</code></pre>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='9'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/3.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="initial-documentation">
            <h2 id="initial-documentation">Initial Documentation</h2>
            
            <p>Before we continue to adding actual logic to allow to preserve <em>alternate</em> comments, let's add some documentation to <em>TrapCSS</em>. The docs are kept in the <strong>documentary</strong> folder and are split by files, which are put in order by documentation software. The <strong>index.md</strong> and <strong>footer.md</strong> files in each of the inner dirs always go first and last respectively. The root <strong>index.md</strong> already contains the description which was placed in there by <em>MNP</em>. It also has the installation snippet and table of contents. But we can add some more text from the forked package to describe what the software will do, and some additional links.</p>
            
            <pre id="c1953"><code class="markdown hljs">&lt;!-- documentary/index.md --&gt;
```sh
yarn add trapcss
npm install -D trapcss
```

## Introduction

_TrapCSS_ takes your HTML and CSS as input and returns only
the used CSS as output. Its custom HTML and CSS parsers are
highly optimized for the 99% use case and thus avoid the
overhead of handling malformed markup or stylesheets, ...

&lt;kbd&gt;📙 [READ WIKI PAGES](../../wiki)&lt;/kbd&gt;

%~%

%TOC%

%~%</code></pre>
            
            <p>We'll give a link to wiki which contains some more detailed information, which will be compiled later. We use section breaks like <span class="tm">%~%</span> which insert visual separators between sections.</p>
            
            <p>The <strong>api/index.md</strong> also contains essential data for generation of the README file:</p>
            
            <pre id="c19531"><code class="markdown hljs">&lt;typedef method="trapcss"&gt;types/api.xml&lt;/typedef&gt;

&lt;typedef&gt;types/index.xml&lt;/typedef&gt;

%EXAMPLE: example, ../src =&gt; trapcss%
%FORK example%</code></pre>
            
            <p><em>Documentary</em> uses components and markers. The typedef component allows to place method headings (when the <span class="tm">method=</span> attribute is given) and markdown tables with record descriptions.</p>
            
            <p>The typedefs will result in the following generated text:</p>
            
            <pre id="c19532"><code class="markdown hljs">## &lt;code&gt;&lt;ins&gt;trapcss&lt;/ins&gt;(&lt;/code&gt;&lt;sub&gt;&lt;br/&gt;&amp;nbsp;&amp;nbsp;`opts: Config,`&lt;br/&gt;&lt;/sub&gt;&lt;code&gt;): &lt;i&gt;Return&lt;/i&gt;&lt;/code&gt;
Parses the supplied HTML and CSS and removes
unused selectors. Also removes empty CSS rules.

 - &lt;kbd&gt;&lt;strong&gt;opts*&lt;/strong&gt;&lt;/kbd&gt; &lt;em&gt;&lt;code&gt;&lt;a href="#type-config" title="Options for the program."&gt;Config&lt;/a&gt;&lt;/code&gt;&lt;/em&gt;: The options for _TrapCSS_.

__&lt;a name="type-config"&gt;`Config`&lt;/a&gt;__: Options for the program.


|     Name      |               Type                |                                                                                                     Description                                                                                                      | Default |
| ------------- | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| __html*__     | &lt;em&gt;string&lt;/em&gt;                   | The input HTML.                                                                                                                                                                                                      | -       |
| __css*__      | &lt;em&gt;string&lt;/em&gt;                   | The CSS to drop selectors from.                                                                                                                                                                                      | -       |
| keepAlternate | &lt;em&gt;boolean&lt;/em&gt;                  | Whether to keep the `@alternate` comment for&lt;br/&gt;Closure Stylesheets.                                                                                                                                                | `false` |
| shouldDrop    | &lt;em&gt;(sel: string) =&gt; boolean&lt;/em&gt; | Whether _TrapCSS_ should remove this selector.&lt;br/&gt;The `shouldDrop` hook is called for every CSS selector&lt;br/&gt;that could not be matched in the html. Return `false`&lt;br/&gt;to retain the selector or `true` to drop it. | -       |


__&lt;a name="type-return"&gt;`Return`&lt;/a&gt;__: Return Type.


|   Name    |            Type             |     Description     |
| --------- | --------------------------- | ------------------- |
| __css*__  | &lt;em&gt;string&lt;/em&gt;             | The dropped CSS.    |
| __sels*__ | &lt;em&gt;!Set&amp;lt;string&amp;gt;&lt;/em&gt; | The used selectors. |</code></pre>
            
            <p>which looks like on the screenshot below:</p>
            
            <p>
              <img class="ImageHolder b-bk b-vk b-t" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px" alt="generated method heading and types" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='777' height='622'/%3E">
              <noscript>
                <picture>
                  <source
                    srcset="/nodetools/pages/trapcss/img/trap-768.webp 768w,/nodetools/pages/trapcss/img/trap-576.webp 576w,/nodetools/pages/trapcss/img/trap-319.webp 319w,/nodetools/pages/trapcss/img/trap-777.webp 777w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px"
                    type="image/webp">
                  <img class="b-bk b-vk b-t" onLoad="webploaded(this)" alt="generated method heading and types" src="/nodetools/pages/trapcss/img/trap-768.png" srcset="/nodetools/pages/trapcss/img/trap-768.png 768w,/nodetools/pages/trapcss/img/trap-576.png 576w,/nodetools/pages/trapcss/img/trap-319.png 319w,/nodetools/pages/trapcss/img/trap-777.png 777w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px">
                </picture>
              </noscript>
            </p>
            
            <p>To generate README, we run the <span class="tm">yarn doc</span> command that consists of: <span class="tm">doc [documentary]</span></p>
            
            <ul>
              <li><strong>-o README.md</strong>: the output file</li>
              <li><strong>-n _trapcss</strong>: the root namespace</li>
              <li><strong>-a</strong>: generate annotations into <span class="tm2">typedefs.json</span></li>
              <li><strong>-d</strong>: verbose debug logging</li>
            </ul>
            
            <p>The default location for input is <strong>documentary</strong> but it can be changed. Method headings can also be <a href="https://github.com/artdecocode/documentary/wiki/Custom-Methods">customised</a> using your own <span class="tm">&lt;method&gt;</span> component. Once again, the dev process for documentation is fully automated and provides customisation strategies so you can express your own creativity with custom method headings. Submit <a href="/nodetools/#getting-help">an issue</a> if you run into difficulties during customisation.</p>
            
            <h3 id="examples-to-outputs">Examples To Outputs</h3>
            
            <p>The second most useful feature of <em>NodeTools</em> after the compiler is the ability to automatically place examples into README, and compute their output which is also added to README. We use the <span class="tm">%EXAMPLE%</span> marker to reference the example file that comes from the <strong>examples</strong> folder. Let's write an example for our program with some HTML and CSS to see if it works.</p>
            
            <pre id="c10fc"><code class="md hljs">%EXAMPLE: example, ../src =&gt; trapcss%</code></pre>
            
            <p>When placing examples, we can actually rename the local import into the package name so it looks professional to our users who can then just copy and paste the example into their own code.</p>
            
            <pre id="ccdbf10"><code class="javascript hljs">import trapcss from '../src'

let html = `
    &lt;html&gt;
        &lt;head&gt;&lt;/head&gt;
        &lt;body&gt;
            &lt;p&gt;Hello World!&lt;/p&gt;
        &lt;/body&gt;
    &lt;/html&gt;
`

let css = `
    html {
      background: yellow;
      /* @alternate */
      background: green;
    }
    .card {
      padding: 8px;
    }
    p:hover a:first-child {
      color: red;
    }
`

const whitelist = /#foo|\.bar/

let dropped = new Set()

let cleaned = trapcss({
  html,
  css,
  shouldDrop(sel) {
    if (whitelist.test(sel))
      return false
    else {
      dropped.add(sel)
      return true
    }
  },
})

console.log(cleaned.css)

console.error(dropped)</code></pre>
            
            <p>To test example before actually compiling docs, we can call <span class="tm">alanode</span> which is simple proxy to Node with require hook that transpiles imports.</p>
            
            <pre id="c414d2"><code class="bash hljs">MacBook:trapcss zavr$ alanode example/
html{background: yellow;background: green;}
Set { '.card', 'p:hover a:first-child' }</code></pre>
            
            <p>The example is working fine, so we can embed it. We're going to modify the markdown file in the following way:</p>
            
            <pre id="c19533"><code class="markdown hljs">&lt;!-- was --&gt;
&lt;!-- %FORK example% --&gt;
&lt;!-- now: --&gt;

%FORK-css example%
%FORKERR-js example%</code></pre>
            
            <p>It's possible to fork a single process and then output both stdout and stderr streams into the documentation. The language of the fork is also given after <span class="tm">FORK-{lang}</span> which means that stdout will be printed as CSS and the stdout as JS code block. Forked JS files are also cached so that if the example and/or any of its dependencies changed, the data will be read from cache which saves a lot of time for more complex programs that might call external APIs or system IO. Specifying language enables syntax highlighting on <em>GitHub</em> so that docs will look neat.</p>
            
            <p>
              <img class="ImageHolder b-vk b-t" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px" alt="example with syntax highlighting on github" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='808' height='120'/%3E">
              <noscript>
                <picture>
                  <source
                    srcset="/nodetools/pages/trapcss/img/trap2-768.webp 768w,/nodetools/pages/trapcss/img/trap2-576.webp 576w,/nodetools/pages/trapcss/img/trap2-319.webp 319w,/nodetools/pages/trapcss/img/trap2-808.webp 808w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px"
                    type="image/webp">
                  <img class="b-vk b-t" onLoad="webploaded(this)" alt="example with syntax highlighting on github" src="/nodetools/pages/trapcss/img/trap2-768.png" srcset="/nodetools/pages/trapcss/img/trap2-768.png 768w,/nodetools/pages/trapcss/img/trap2-576.png 576w,/nodetools/pages/trapcss/img/trap2-319.png 319w,/nodetools/pages/trapcss/img/trap2-808.png 808w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px">
                </picture>
              </noscript>
            </p>
            
            <p>When documenting code, we can keep <em>Documentary</em> running with the <span class="Manager" id="cb985">yarn doc -p [commit message]</span> command. It will watch for changes in the source folder, as well as any assets such as examples, automatically replace the last commit when changes are detected, and force push the new git tree. So we can work on examples and styling of the docs, and immediately see updates on <em>GitHub</em>.</p>
            
            <p>At this point, without having written any tests, we already confirmed that our package is working correctly, because we managed to execute the example and place its output into the README file. This is called using documentation for quality assurance, as it lets us see the expected output. If the output was different from the one we wanted (or no output at all), we'd realise that by the time our documentation is placed on <em>GitHub</em> (in automatic mode) or in git diffs (when running single <span class="Manager" id="c824f">yarn doc</span> command).</p>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='9'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/4.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="creating-tests">
            <h2 id="creating-tests">Creating Tests</h2>
            
            <p>Tests for the original packages were written for <em>Mocha</em> testing framework, but we need to update them into <em>Zoroaster</em> context-testing specs and masks. Let's take the first test suite and have a look at its structure:</p>
            
            <pre id="ccdbf11"><code class="javascript hljs">const dropcss = require('../../src/dropcss.js')
const assert = require('assert')

describe('Context-free, unary selector', () =&gt; {
  let html, css

  describe('*', () =&gt; {
    it('should retain present', function() {
      let { css: out } = dropcss({
        html:	'&lt;div&gt;&lt;/div&gt;',
        css:	'* {a:b;}',
      })
      assert.equal(out, '*{a:b;}')
    })
  })

  describe('&lt;tag&gt;', () =&gt; {
    it('should retain present', function() {
      let { css: out } = dropcss({
        html:	'&lt;div&gt;&lt;/div&gt;',
        css:	'div {a:b;}',
      })
      assert.equal(out, 'div{a:b;}')
    })

    it('should drop absent', function() {
      let { css: out } = dropcss({
        html:	'&lt;div&gt;&lt;/div&gt;',
        css:	'span {a:b;}',
      })
      assert.equal(out, '')
    })
  })

  describe('#id', () =&gt; {
    it('should retain present', function() {
      let { css: out } = dropcss({
        html:	'&lt;div id="a"&gt;&lt;/div&gt;',
        css:	'#a {a:b;}',
      })
      assert.equal(out, '#a{a:b;}')
    })

    it('should drop absent', function() {
      let { css: out } = dropcss({
        html:	'&lt;div id="a"&gt;&lt;/div&gt;',
        css:	'#b {a:b;}',
      })
      assert.equal(out, '')
    })
  })
})</code></pre>
            
            <p>We can see that each time the logic is pretty much the same: we use the <span class="tm">&lt;div&gt;&lt;/div&gt;</span> html as HTML string for first cases, but change it to <span class="tm">&lt;div id=&quot;a&quot;&gt;&lt;/div&gt;</span> for ID selector tests, then manipulate some CSS from test to test and expect the result to be equal to certain values. Tests like that are perfect candidates for mask testing &mdash; a new type of tests where using a template called test mask we generate many specs at runtime based on multiple input-to-output mappings that come from a separate file called mask result.</p>
            
            <p>So what are we controlling? Basically, it's HTML and CSS, and we assert on the output. This means we need 2 input properties, and one output. Masks by default look like the following:</p>
            
            <pre id="c19534"><code class="markdown hljs">[Optional preamble to the whole mask]

## test name
input

/* property */
some value
/**/
/* expected */
output
/**/

## test name2
input

/* property */
some controlled value
/**/
/* expected */
output 2
/**/</code></pre>
            
            <p>This means we give spec names, can add any number of properties, and pass the expected output for comparison also. The testing framework will then execute the test logic that is written only one, and using string assertion (or deep equal for objects), compare the output to expected. In case of an error, it will be shown in the console and the framework will exit with status code > 0.</p>
            
            <p>In this case, we can construct the following mask.</p>
            
            <pre id="ccdbf12"><code class="javascript hljs">import makeTestSuite from '@zoroaster/mask'
import trapcss from '../../src'

// todo: test [foo="val"], [foo='val'], :not([attr~=value])
const contextFreeUnarySel = makeTestSuite(
  'test/result/0-context-free-unary-sel', {
    getResults() {
      let html, css
      if (!this.preamble) {
        [html, ...css] = this.input.split('\n')
        css = css.join('\n')
      } else {
        html = this.preamble
        css = this.input
      }
      [,html] = /content: '(.+?)'/.exec(html)
      return trapcss({ html, css })
    },
    mapActual({ css }) {
      return css
    },
  })

export default {
  'Context-free, unary selector': contextFreeUnarySel,
}</code></pre>
            
            <p>To create a mask, we import the <strong>makeTestSuite</strong> method from <span class="tm2">@zoroaster/mask</span> that comes together with <em>Zoroaster</em>. The first argument to this function is a path to the mask result file, or directory with multiple such files, that will be scanned recursively. The second argument is the actaul config to the mask, and will include either methods like <span class="tm">getResults</span>, <span class="tm">getReadable</span>, <span class="tm">getTransform</span> or <span class="tm">fork</span> configuration. All properties from the mask are available via the <span class="tm">this</span> keyword: <strong>this.preamble</strong>, <strong>this.input</strong>. We'll organise tests by files, so that a preamble in each file can be used as HTML input, whereas input to the test will be the CSS string. When we don't write preamble, we'll split the test input by new line to derive HTML and CSS.</p>
            
            <p>We want to extract HTML using the regex: <span class="tm">[,html] = /content: '(.+?)'/.exec(html)</span>, to be able to receive syntax highlighting in mask results, which will be saved as <span class="tm">.scss</span> files. After those inputs are prepared, we simply pass them to <span class="tm2">trapcss</span> and return the results. Using the mapping function <span class="tm">mapActual</span> we then return the css property of the whole result, so that it can be compared against the expected one from the mask result. If we wanted to assert on other properties too using JavaScript, we could implement another method called <span class="tm">assertResults</span> but we're only interested in testing produced CSS here. This is how our mask results look like:</p>
            
            <pre id="cf5412"><code class="scss hljs">// *: should retain present
html { content: '&lt;div&gt;&lt;/div&gt;' }
* {a:b;}

/* expected */
*{a:b;}
/**/</code></pre>
            
            <p>This is the default mask result for the very first test, without a preamble, but with HTML followed by CSS in inputs. The tests are separated by the comment <span class="tm">//</span> characters &mdash; a default unless a markdown file is used, in which case it'd be <span class="tm">##</span>. This can also be controlled via the <span class="tm">splitRe</span> setting of the mask config.</p>
            
            <pre id="cf5413"><code class="scss hljs">html { content: '&lt;div&gt;&lt;/div&gt;' }

// should retain present
div {a:b;}

/* expected */
div{a:b;}
/**/

// should drop absent
span {a:b;}

/* expected */
/**/

// :not - should retain present
:not(span) {a:b;}

/* expected */
:not(span){a:b;}
/**/

// :not - should drop absent
:not(div) {a:b;}

/* expected */
/**/</code></pre>
            
            <p>This is the mask result for test suite with the tag testing, where HTML is given at the top of the file (called preamble) to be accessed by each test. We can also duplicate this file and change the div tag to self-closing tag in a single place (preamble), to increase test coverage easily. Where the output of the test is expected to be a 0-length string, we just leave the expected property empty.</p>
            
            <pre id="cf5414"><code class="scss hljs">html { content: '&lt;div id="a"&gt;&lt;/div&gt;' }

// should retain present
#a {a:b;}

/* expected */
#a{a:b;}
/**/

// should drop absent
#b {a:b;}

/* expected */
/**/

// :not - should retain present
:not(#b) {a:b;}

/* expected */
:not(#b){a:b;}
/**/

// :not - should drop absent
:not(#a) {a:b;}

/* expected */
/**/</code></pre>
            
            <p>These are tests for the ID selector, where we used preamble as HTML input for all tests. We write such html as the <span class="tm">content</span> property of the CSS rule, so that the IDE will provide syntax highlighting for the best pleasant developer experience while testing. There are more tests for attribute selectors which you can <a
              href="https://github.com/kumarikandam/trapcss/tree/master/test/result/0-context-free-unary-sel/attr">
              study in the repository</a> but they all follow the same logic so we skip talking about them here.</p>
            
            <p>To run our tests, there are a number of <strong>package.json</strong> scripts that can be used: <span class="tm">yarn [spec|mask|test]</span> depending on whether we want to run specs (not done yet), masks or all. We'll just run <span class="tm">yarn mask</span> after having constructed our first mask tests.</p>
            
            <pre id="c414d3"><code class="bash hljs">yarn run v1.13.0
$ yarn t test/mask
$ zoroaster -a test/mask
 test/mask
   bin
   unary
     Context-free, unary selector
      ✓  *: should retain present
       #id
        ✓  should retain present
        ✓  should drop absent
        ✓  :not - should retain present
        ✓  :not - should drop absent
       .class
        ✓  should retain present
        ✓  should drop absent
        ✓  :not - should retain present
        ✓  :not - should drop absent
       &lt;tag&gt;
        ✓  should retain present
        ✓  should drop absent
        ✓  :not - should retain present
        ✓  :not - should drop absent
       &lt;tag⁄&gt;
        ✓  should retain present
        ✓  should drop absent
        ✓  :not - should retain present
        ✓  :not - should drop absent
       attr
        ✓  [attr]: should retain present
        ✓  [attr]: should drop absent
        ✓  [attr=value]: should retain present
        ✓  [attr=value]: should drop absent
        ✓  [attr*=value]: should retain present
        ✓  [attr*=value]: should drop absent
        ✓  [attr^=value]: should retain present
        ✓  [attr^=value]: should drop absent
        ✓  [attr$=value]: should retain present
        ✓  [attr$=value]: should drop absent
        ✓  [attr~=value]: should retain present
        ✓  [attr~=value]: should retain present (multiple first)
        ✓  [attr~=value]: should retain present (multiple second)
        ✓  [attr~=value]: should drop absent
        ✓  [attr~=value]: should drop absent (reverse)
         :not
          ✓  [attr]: should retain present
          ✓  [attr]: should drop absent
          ✓  [attr=value]: should retain present
          ✓  [attr=value]: should drop absent
          ✓  [attr*=value]: should retain present
          ✓  [attr*=value]: should drop absent
          ✓  [attr^=value]: should retain present
          ✓  [attr^=value]: should drop absent
          ✓  [attr$=value]: should retain present
          ✓  [attr$=value]: should drop absent

🦅  Executed 42 tests.
Done in 1.85s.</code></pre>
            
            <h3 id="focus-in-masks">Focus In Masks</h3>
            
            <p>To focus on a particular test, we can prepend its name with <span class="tm">!</span> in the mask result like so:</p>
            
            <pre id="cf541"><code class="scss hljs">// !should retain present
#a {a:b;}

/* expected */
#a{a:b;}
/**/</code></pre>
            
            <p>It's also possible to focus on entire masks, by adding <span class="tm">!</span> to the path of a mask result, or exporting the mask with <span class="tm">$</span> name:</p>
            
            <pre id="ccdbf8"><code class="javascript hljs">// use ! in mask result path
const contextFreeUnarySel = makeTestSuite(
  '!test/result/0-context-free-unary-sel', {
    getResults() {},
    // ...
  })

// named export with $
export const $contextFreeUnarySel = makeTestSuite(
  'test/result/0-context-free-unary-sel', {
    getResults() {},
    // ...
  })

// export with $ in object
export default {
  '$Context-free, unary selector': contextFreeUnarySel,
}</code></pre>
            
            <p>In <em>Zoroaster</em>, test suites are nested objects. For better reporting, we exported the default test suite as an object with the <span class="tm">Context-free, unary selector</span> property that contains the test suite generated by the mask. But we could also simply export a variable using a named export, it's just that we won't be able to report the test suite name as a sentence with whitespace and commas.</p>
            
            <h3 id="interactive-mode">Interactive Mode</h3>
            
            <p>If the test was failing, <em>Zoroaster</em> would use string comparison algorithm to present where the error was in color. Let's imagine we entered our expected value incorrectly:</p>
            
            <pre id="cf5411"><code class="scss hljs">// !should retain present
#a {a:b;}

/* expected */
.a{a:c;}
/**/</code></pre>
            
            <p>The error will be shown using color highlighting in the CLI. Moreover, it's possible to run <em>Zoroaster</em> in <strong>interactive</strong> mode with the <span class="tm">-i</span> flag that will tell the testing framework that we want to interact with it to update mask results in place if errors were found, as demonstrated below.</p>
            
            <p>
              <img class="b-vk b-bk b-t" alt="using testing framework zoroaster to update mask results in place" data-io>
              <noscript>
                <img class="b-vk b-bk b-t" alt="using testing framework zoroaster to update mask results in place" src="/nodetools/pages/trapcss/img/i.gif">
              </noscript>
            </p>
            
            <p>The default option is to update, but more info can be shown if <span class="tm">d</span> is pressed, or no updates are made if anything else is passed, in which case the test suite will fail. This is a useful method for quickly drafting the inputs with empty outputs, running interactive mode on them, and populating mask files with expected outputs.</p>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='10'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/5.svg"></noscript></a>
            </p>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer class="b-ns">
      &copy; <a href="https://www.artd.eco">Art Deco™</a>, 2020
    </footer>
    <script>(function(){function b(){if(0<c.length){var a=c.shift();a.src=a.getAttribute("data-src");a.removeAttribute("data-src");a.onload=b;a.onerror=function(){console.warn("Could not load script %s",a.src)}}}var c=Array.prototype.slice.call(document.querySelectorAll("script[data-src]"));b()})()</script>
  </body>
</html>