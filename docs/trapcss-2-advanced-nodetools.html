<!doctype html>
<html class="no-js b-Op" lang="en">
  <head>
    <meta charset="utf-8">
    <title>TrapCSS 2: Advanced NodeTools</title>
    <meta content="https://art-deco.github.io/nodetools/trapcss-2-advanced-nodetools.html" property="og:url">
    <meta content="TrapCSS 2: Advanced NodeTools" property="og:title">
    <meta content="website" property="og:type">
    <meta content="https://art-deco.github.io/nodetools/pages/trapcss2/img/trapcss2.jpg" property="og:image">
    <meta
      content="A continuation of NodeTools tutorial that describes how to create Node.JS binary, compile it and libarary with Closure Copmiler and generate Wiki pages." name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link sizes="57x57" rel="apple-touch-icon" href="/nodetools/img/fav-57.png">
    <link sizes="76x76" rel="apple-touch-icon" href="/nodetools/img/fav-76.png">
    <link sizes="120x120" rel="apple-touch-icon" href="/nodetools/img/fav-120.png">
    <link sizes="152x152" rel="apple-touch-icon" href="/nodetools/img/fav-152.png">
    <link sizes="167x167" rel="apple-touch-icon" href="/nodetools/img/fav-167.png">
    <link sizes="180x180" rel="apple-touch-icon" href="/nodetools/img/fav-180.png">
    <link sizes="192x192" rel="icon" href="/nodetools/img/fav-192.png">
    <link sizes="128x128" rel="icon" href="/nodetools/img/fav-128.png">
    <link sizes="32x32" rel="icon" href="/nodetools/img/fav-32.png">
    <link
      href="https://fonts.googleapis.com/css?display=swap&amp;family=Ruda%3A400%2C700%7CMr%20De%20Haviland" rel="preload" as="fetch" crossOrigin>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossOrigin>
    <link href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700" rel="preload"
      as="style">
    <script>
      (function(b){var a=document.createElement("link");a.href=b;a.rel="stylesheet";a.crossOrigin="crossorigin";document.head.appendChild(a)})('https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700')
    </script>
    <style id="cpt">
      
        h1 { font-family: 'Mr De Haviland' }
    
      @font-face {
        font-family: 'Mr De Haviland';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Mr De Haviland Regular'), local('MrDeHaviland-Regular'), url('data:application/font-woff2;base64,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') format('woff2');
      }
      
    </style>
    <script>
      (function(){var b=/url\('([\s\S]+?)'\)/.exec(document.head.querySelector("#cpt").textContent);if(b){var a=document.createElement("link");a.rel="preload";a.as="font";a.href=b[1];document.head.appendChild(a)}})()
    </script>
    <script>(function(h,r){var a=Object.keys(h),c=!0;"CSS"in window&&"supports"in CSS?(a=a.reduce(function(k,b){var l=h[b];b=b.split("|");for(var m=!1,d={},f=0;f<b.length;d={a:d.a},f++)if(d.a=b[f],l.map(function(n){return function(e){e=e.split("|");for(var p=!1,g=0;g<e.length;g++){var q=e[g];if(CSS.supports(n.a,q)){p=!0;break}else k.push(n.a+": "+q)}return p}}(d)).filter(Boolean).length==l.length){m=!0;break}m||(c=!1);return k},[]),a.length?c&&console.log("\ud83d\udcbf Browser does not support CSS properties: %s",
a.join("\n "),"but supports alternatives."):console.log("\ud83d\udcbd Browser supports all modern CSS properties.")):(c=!1,console.log("\ud83d\udce0 Browser does not support CSS checks."));c||(a=document.createElement("link"),a.rel="stylesheet",a.href=r,document.head.appendChild(a))})({"align-self":["center"],"flex-grow|-ms-flex-positive":["1"],"flex|-ms-flex":["0 0 25%"],"display":["flex|-ms-flexbox"],"box-sizing":["border-box"],"order|-ms-flex-order":["1"],"transition":["none"],"flex-direction|-ms-flex-direction":["column"],"border-radius":["2px"],"box-shadow":["none"],"flex-basis|-ms-flex-preferred-size":["0"],"hyphens|-webkit-hyphens|-ms-hyphens":["auto"],"justify-content":["center"],"flex-wrap|-ms-flex-wrap":["wrap"],"flex-shrink|-ms-flex-negative":["0"],"position":["sticky|-webkit-sticky"],"align-items":["center"]}, '/nodetools/css/combined-prefixes.css')</script>
    <script>
      (function(q,k){function x(a){for(var f=/url\((.+?)\).*?;\s+unicode-range: (.+?);/g,b={},d=[],h;h=f.exec(a);){var r=h[2];d.push({url:h[1],a:r});b[r]=1}b=Object.keys(b).reduce(function(c,e){var g=e.split(/,\s/).map(function(l){return l.replace("U+","\\u").replace("-","-\\u")}).join("").toLowerCase();c[e]=new RegExp("["+g+"]");return c},{});var t=document.body?document.body.textContent:"",y=t?Object.keys(b).reduce(function(c,e){b[e].test(t)&&(c[e]=!0);return c},{}):Object.keys(b).reduce(function(c,
      e){e in k&&(c[e]=!0);return c},{});m=d.filter(function(c){return c.a in y}).map(function(c){return c.url});if(!m.length)return u();var v=document.createDocumentFragment();m.forEach(function(c,e){var g=document.createElement("link");g.href=c;g.rel="preload";g.as="font";var l=e+1;;g.onload=function(){return u(l)};g.setAttribute("crossorigin",!0);v.appendChild(g)});document.head.appendChild(v)}k=void 0===k?{}:k;var n=document.createElement("link");if(function(a,
      f){if(!a||!a.supports)return!1;try{return a.supports(f)}catch(b){return!1}}(n.relList,"preload")){var z=function(a,f,b){b=void 0===b?"":b;;var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&(200==d.status?(f(d.responseText)):console.error("Error loading webfont: server responded with code %s at %s",d.status,a))};d.open("GET",a);try{d.send(null)}catch(h){console.error(h)}};
      ;var p;(function(a,f){z(a.href,function(b){p=b;x(p)},"-"+(void 0===f?"link":f))})({href:q},"js");var m=[],w=0,u=function(a){w++;w>=m.length&&(a=document.createElement("style"),a.innerHTML=p,document.head.appendChild(a))}}else n.rel="stylesheet",n.href=q,document.head.appendChild(n)})('https://fonts.googleapis.com/css?display=swap&family=Ruda%3A400%2C700%7CMr%20De%20Haviland', {"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD":true})
    </script>
    <link rel="stylesheet" href="/nodetools/css/combined.css">
    <link rel="preload" as="style" href="/nodetools/highlight.js/styles/default.css">
    <style>
      .no-js [data-io], .no-js .ImageHolder, .no-js [data-loading] { display: none!important }
      .List {
                          font-size:small;
                        }
                        .List > a {
                          display: block!important;
                        }
    </style>
    <noscript>
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?display=swap&amp;family=Mr%20De%20Haviland&amp;text=TrapCSS2%3A%20Advanced%20NodeTools">
      <link rel="stylesheet" href="/nodetools/css/combined-prefixes.css">
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?display=swap&amp;family=Ruda%3A400%2C700%7CMr%20De%20Haviland">
      <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro%3A400%2C700">
    </noscript>
    <script defer src="/nodetools/js/polyfill/intersection-observer.js"></script>
    <script defer src="/nodetools/js/images.js"></script>
    <script crossorigin data-src="/nodetools/preact/dist/preact.min.js"></script>
    <script crossorigin data-src="/nodetools/comps/common.js"></script>
    <script crossorigin data-src="/nodetools/comps/trapcss2.js"></script>
    <script>
      document.documentElement.classList.remove("no-js")
    </script>
  </head>
  <body class="b-Mk b-Ol b-Op">
    
    <main class="b-Xl" role="main">
      <div class="b-z">
        <div class="b-B">
          <div class="left-column b-hb">
            <div class="b-kC">
            
                <img class="ImageHolder b-t b-vk" sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px" alt="@artdeco/nodetools logo" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='600' height='400'/%3E">
                <noscript>
                  <picture>
                    <source srcset="/nodetools/img/splash-576.webp 576w,/nodetools/img/splash-319.webp 319w,/nodetools/img/splash-600.webp 600w"
                      sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px" type="image/webp">
                    <img class="b-t b-vk" onLoad="webploaded(this)" alt="@artdeco/nodetools logo" src="/nodetools/img/splash-576.jpg" srcset="/nodetools/img/splash-576.jpg 576w,/nodetools/img/splash-319.jpg 319w,/nodetools/img/splash-600.jpg 600w" sizes="(max-width: 575.8px) 100vw,(max-width: 767.8px) 510px,(max-width: 991.8px) 150px,(max-width: 1199.8px) 210px,255px">
                  </picture>
                </noscript>
              </div>
              <div class="b-kC">
                <a title="The NodeTools Stack Website." class="GitHubBadge" id="cacd9"
                  href="https://github.com/art-deco/nodetools">
                  <span class="a">GitHub</span><span class="b" data-stargazers>⭐️ 1</span></a>
                
                
                
              </div>
              <h3 id="pages">Pages</h3>
              <ul id="PagesMenu">
                <li class><a data-file="index" href="/nodetools/">NodeTools: Node.JS Stack</a></li>
                <li class>
                  <a data-file="quick-start" href="/nodetools/quick-start-to-nodetools.html">Quick Start To NodeTools</a>
                </li>
                <li class>
                  <a data-file="trapcss" href="/nodetools/trapcss-nodetools-tutorial.html">TrapCSS: NodeTools Tutorial</a>
                </li>
                <li class="Active">
                  <a data-file="trapcss2" href="/nodetools/trapcss-2-advanced-nodetools.html">
                    TrapCSS 2: Advanced NodeTools</a>
                </li>
                <li class>
                  <a data-file="babel" href="/nodetools/babel-when-open-source-is-not-free-sofware.html">
                    Babel: When Open Source Is Not Free Sofware</a>
                </li>
                <li class>
                  <a data-file="discussion" href="/nodetools/discussion-for-nodetools.html">Discussion for NodeTools</a>
                </li>
              </ul>
              <h3 id="stack">Stack</h3>
              <div class="List b-xq b-kC">
                <a
                  title="Create Packages From GitHub Templates. My New Package is an installer of new packages via GitHub templates: create a template and add an automated script to CLI questions, update files, access GitHub API and spawn commands during generation." class="NPMBadge" href="https://www.npmjs.com/package/mnp">
                  <span class="a"><em>MNP</em></span><span class="b">1.1.0</span></a>
                <a
                  title="Organises TypeDefs By Placing Them Into Types.Xml File To Be Embedded Into Source Code Compatible With VSCode And Google Closure Compiler, Generates Externs And Allows To Place Documentation In README Markdown." class="NPMBadge" href="https://www.npmjs.com/package/typal">
                  <span class="a"><em>Typal</em></span><span class="b">1.26.0</span></a>
                <a
                  title="Proper Node.JS Package Compiler (And Front-End Code Bundler) With Closure Compiler. Can create a single executable JS file and merge and optimise all dependencies." class="NPMBadge" href="https://www.npmjs.com/package/depack">
                  <span class="a"><em>Depack</em></span><span class="b">1.1.0</span></a>
                <a
                  title="A Regex-Based Transpiler Of Source Code To Allow Writing Import And Export Statements And JSX With 0 Dependencies." class="NPMBadge" href="https://www.npmjs.com/package/alamode">
                  <span class="a"><em>ÀLaMode</em></span><span class="b">3.3.1</span></a>
                <a
                  title="The 2019 Most Modern Testing Framework For Node.JS With Test Contexts (Reusable BeforeEach / AfterEach Via Separate Files); Masks (Inputs/Outputs In Non-Js Files) And Fork Testing; Interactive Snapshots." class="NPMBadge" href="https://www.npmjs.com/package/zoroaster">
                  <span class="a"><em>Zoroaster</em></span><span class="b">4.1.2</span></a>
                <a
                  title="Documentation Compiler To Generate The Table Of Contents, Embed Examples With Their Output, Make Markdown Tables, Maintain Typedefs For JavaScript And README, Watch Changes To Push, Use Macros And Prettify API Titles." class="NPMBadge" href="https://www.npmjs.com/package/documentary">
                  <span class="a"><em>Documentary</em></span><span class="b">1.35.10</span></a>
              </div>
              <h3 id="web-software">Web Software</h3>
              <div class="List b-xq b-kC">
                <a
                  title="2-Dependency Koa Web Server Compiled With Closure Compiler And Bundled With Essential Middleware: Static, Compress, Session, Cors, File Upload, Router And JSX Front End." class="NPMBadge" href="https://www.npmjs.com/package/@idio/idio">
                  <span class="a"><em>Idio</em></span><span class="b">1.2.3</span></a>
                <a
                  title="Static Web Site Compiler That Uses Closure Compiler For JS Bundling And Closure Stylesheets For CSS optimisations. Supports JSX Syntax To Write Static Elements And Dynamic Preact Components." class="NPMBadge" href="https://www.npmjs.com/package/splendid">
                  <span class="a"><em>Splendid</em></span><span class="b">1.16.15</span></a>
              </div>
              <h3 id="misc">Misc</h3>
              <ul>
                <li><a href="https://gitter.im/node_tools/community">Get Help In Gitter Chat</a></li>
                <li><a href="https://opencollective.com/nodetools">Fund Us On Open Collective</a></li>
              </ul>
              <div class="SideBarMenu sidebarshowing b-jr b-zp">
                <div class="a">
                  
                                  <h3 id="on-this-page">On This Page</h3>
                                  <ul class="OnThisPage">
                                    <li data-heading="trapcss-2"><a href="#trapcss-2">TrapCSS 2</a></li>
                                    <li data-heading="welcome-closure">
                                      <a href="#welcome-closure">Welcome Closure</a>
                                      <ul><li data-heading="installation"><a href="#installation">Installation</a></li><li data-heading="advantages"><a href="#advantages">Advantages</a></li><li data-heading="web-bundling"><a href="#web-bundling">Web Bundling</a></li></ul>
                                    </li>
                                  </ul>
                                  <h3 id="share-nodetools">Share NodeTools</h3>
                                  <span class="b-xq b-Hk" id="ce0df"><span class="b-Hk" style="height:32px" data-loading>Loading sharing buttons...</span><noscript>Please enable JavaScript to Share</noscript></span>
                                  
                                  <div class="b-xq" data-loading id="updates-div">Loading web-push...</div>
                                  <details id="NewsletterDetails" data-loading>
                                    <summary>
                                      <h3 id="newsletter">Newsletter</h3>
                                    </summary>
                                    <div id="emails-div">Loading widget...</div>
                                  </details>
                                  <div class="b-jq" data-loading>
                                    <h3 class="b-Gk" id="package-manager">Package Manager</h3>
                                    <form class="b-Gk" id="ca13e">
                                      <select><option value="yarn">yarn</option><option selected value="npm">npm</option></select>
                                    </form>
                                  </div>
                                
                </div>
                <a data-loading id="HideMenu" style="color:grey!important;" href="#">hide menu</a>
                <a data-loading id="ShowMenu" style="color:grey!important;" href="#">show menu</a>
              </div>
          </div>
          
          <div class="right-column b-xq b-nb" id="Content">
            
            
            <div data-section id="trapcss-2">
            <h1>TrapCSS2: Advanced NodeTools</h1>
            
            <p>In the previous part, we looked at the first steps in creating a new package with <em>NodeTools</em> stack. During the initialisation process with <span class="tm">mnp</span>, we were asked some questions like if we wanted to compile the package, if a binary should be added and whether <em>GitHub</em> wiki should be created. We answered yes to all three questions, so let's get on with the second part of the tutorial.</p>
            
            <p>
              <img class="ImageHolder b-vk b-t" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px" alt="trapcss2: advanced nodetools tutorial (car splash)" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='668'/%3E">
              <noscript>
                <picture>
                  <source
                    srcset="/nodetools/pages/trapcss2/img/trapcss2-768.webp 768w,/nodetools/pages/trapcss2/img/trapcss2-576.webp 576w,/nodetools/pages/trapcss2/img/trapcss2-319.webp 319w,/nodetools/pages/trapcss2/img/trapcss2-1000.webp 1000w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px"
                    type="image/webp">
                  <img class="b-vk b-t" onLoad="webploaded(this)" alt="trapcss2: advanced nodetools tutorial (car splash)" src="/nodetools/pages/trapcss2/img/trapcss2-768.jpg" srcset="/nodetools/pages/trapcss2/img/trapcss2-768.jpg 768w,/nodetools/pages/trapcss2/img/trapcss2-576.jpg 576w,/nodetools/pages/trapcss2/img/trapcss2-319.jpg 319w,/nodetools/pages/trapcss2/img/trapcss2-1000.jpg 1000w" sizes="(max-width: 575.8px) 100vw,(max-width: 991.8px) 540px,(max-width: 1199.8px) 720px,855px">
                </picture>
              </noscript>
            </p>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='15'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/0.svg"></noscript></a>
            </p>
            </div>
            
            <div data-section id="welcome-closure">
            <h2>Welcome Closure</h2>
            
            <p>Prior to <em>NodeTools</em>, the industry standard was to simply transpile source code with <em>Babel</em>, or not use modules at all and avoid transpilation step altogether. The first option is not good because <em>Babel</em> is a package with 250+ dependencies that jam our <span class="tm2">node_modules</span>, and also because for years it's been disparaging professional software engineering values that are in core of <em>NodeTools</em>, such as respect for <em>JSDoc</em>, as can be read in the <a href="/nodetools/babel-when-open-source-is-not-free-sofware.html">
               Babel: When Open Source Is Not Free Sofware</a> article. The second option is not applicable either as I believe in embracing innovation and keeping up with the newest technological advances to be able to be productive and remain competent and competitive.</p>
            
            <p>Because <span class="tm">NearForm</span>, the <a href="https://www.nearform.com/community/">largest contributor</a> to Node.JS with labour resource of over 100 people, extorted back-end engineers into using <em>Babel</em> by not implementing ECMA modules since 2015, the actual state of art of modern package making is pretty sad, although those working on <em>Babel</em> think so highly of themselves due to all that forced downloads count that they call their low-quality product a compiler, which is not true. A compiler is a sophisticated piece of software so there must be something special about a program to be called this name (rather than a transpiler). <em>Closure Compiler</em> is software that will check types and perform advanced passes like peep-hole optimisation and function call folding, therefore it really deserves this title.</p>
            
            <p>Up until <em>NodeTools</em>, there were 4 ways to create <strong>Node.JS</strong> packages:</p>
            
            <ol>
              <li><strong>old-school</strong>, by keeping <span class="tm">module.exports</span> and not taking advantage of modules' syntax which is one of the best features of JavaScript;</li>
              <li><strong>alternative</strong>, that included an additional bundle up step, with such software as rollup and webpack;</li>
              <li><strong>TypeScript</strong>, which is a corporate paradigm that has swept the world due to the lack of professional tools that could compete with it to provide good routines for working with types;</li>
              <li><strong>Babel</strong>, the mass-mentality industry pattern that has no respect for its users, whose authors self-proclaimed themselves leaders of the sector while failing miserably to meet essential requirements for a transpiler.</li>
            </ol>
            
            <p><em>NodeTools</em> is the new simplest replacement to all this methods that allows to leave them behind and focus on JS coding. We provide the most light-weight, pure <em>JavaScript</em> solution that would allow to develop professional packages and keep independent from 3rd party software that dictates how you should work and what <em>your</em> code should look like. The developer and her freedom is our top priority. For example, there's literally no config for compiling you packages, and all annotations are based on the open JSDoc standard. You can still choose the language output (such as ECMA2015-2019) and control other options like pretty printing via CLI arguments. <em>NodeTools</em> is the only methodology that starts to use <em>Closure Compiler</em> for packages, and it takes Node.JS software development to the next level.</p>
            
            <div data-section id="installation">
            <h3>Installation</h3>
            
            <p><em>Closure Compiler</em> is developed by Google. It's used for mission-critical internal projects, that are not based on TypeScript. It's a Java program of the size of 10MB that can be installed once on the system, and using advanced optimisations, can put the source code, as well as all liked dependencies into a single executable file. In other words, it provides static linking for libraries into our generated code. Type checking now becomes the final stage of the development process that provides insight into small inaccuracies in our types, instead of forcing us to think in terms of types, like in <em>TypeScript</em>.</p>
            
            <p>To use the compiler, you'll need Java on your machine. Then we're going to install <span class="tm">google-closure-compiler-java</span> into the home folder:</p>
            
            <pre id="c414d"><code class="bash hljs">cd ~
yarn|npm init # we want to save deps in package.json
yarn add google-closure-compiler-java</code></pre>
            
            <p>
            Your distribution will be installed in the <strong>~/node_modules</strong> directory.
            On top of the compiler itself, the actual package that executes the process, is called <em>Depack</em>. It's made possible to compile Node.JS package for the first time, since it wasn't possible before as when trying to compile back-end software with Closure, it would throw errors since it couldn't recognise internal Node API, such as <span class="tm">fs</span>, <span class="tm">stream</span>, <em>etc</em>. <em>Depack</em> fixes this by creating mock folders in your <span class="tm">node_modules</span>,
            such as <strong>node_modules/fs/index.js</strong>,
            <strong>node_modules/fs/package.json</strong> that simply destructure the global API annotated via externs to enable type checking. We've implemented the externs for Node 8 API, which should also work with later versions.
            </p>
            
            <pre id="ccdbf"><code class="javascript hljs">// node_modules/child_process/index.js
/* a mock of child process built-in */

export default child_process
export const {
  ChildProcess,
  exec,
  execFile,
  execFileSync,
  execSync,
  fork,
  spawn,
  spawnSync,
} = child_process</code></pre>
            
            <pre id="ccdbf1"><code class="javascript hljs">// node_modules/child_process/package.json
{
  "name": "child_process",
  "main": "index.js"
}</code></pre>
            
            <p>You can use nightly versions of the compiler, if you want, by looking up the last version with <span class="Manager"> <span><span class="yarn-cmd">yarn </span><span class="npm-cmd">npm </span><span>info</span> <span>google-closure-compiler-java</span></span></span> and setting the exact version, e.g., <span class="Manager"> <span><span class="yarn-cmd">yarn </span><span class="npm-cmd">npm </span><span class="npm-cmd">i</span><span class="yarn-cmd">add</span> <span>google-closure-compiler-java@20200201.0.0-nightly</span></span></span>. This can help if there are occasional bugs in the compiler, e.g., the January 2020 version has broken destructuring, so you need to use the nightly build like the one I've just mentioned. There's a list of bugs in the compiler in the <a href="https://github.com/dpck/depack/wiki/Bugs"><em>Depack</em> wiki</a>.</p>
            
            <p><em>Closure</em> is written in Java. You can fork <a href="https://github.com/google/closure-compiler">their project</a> and study how it works. There's a lot of useful information on the <a href="https://github.com/google/closure-compiler/wiki">Wiki</a>, especially in the types section. It might seem complex at first, but I managed to fix certain issues with PRs by only studying the source code for a few days. A compiler is based on AST passes, where you can manipulate nodes. There's also a JSDoc parser, and an inner project for JS source map consumption/generation. When you make a change, you build the compiler locally. Then you can set the <span class="tm">GOOGLE_CLOSURE_COMPILER</span> env variable with the path to your target JAR, which will then be used by <em>NodeTools</em>.</p>
            
            
            </div>
            
            <div data-section id="advantages">
            <h3>Advantages</h3>
            
            <p>Some might say that we're still tied up to the compiler, but it's much better than Babel and TypeScript, because:</p>
            
            <ul>
              <li>You don't need to install 250 dependencies just for your modules' syntax via <em>Babel</em>.</li>
              <li>The bin size is 10mb instead of 50mb of <span class="tm">TypeScript</span>.</li>
              <li>You can statically link packages like in proper software engineering.</li>
              <li>Compiler will produce type hints for you that are useful to polish your programs, but don't lock you into a completely different language which TS is.</li>
              <li>It's meant for pure JavaScript development which is great.</li>
              <li>Its advanced optimisation obfuscates code so that you can send it to your clients with a bit more security for your intellectual property.</li>
              <li>You can compile complex back-end applications into a single JS file, for example, we created <a href="https://github.com/idiocc/idio">Idio</a> which is a Koa server with essential middleware that only has 2 dependencies (<span class="tm">mime-db</span> and <span class="tm">text-decoding</span> which are databases for processing encoded data). Without compilation, <span class="tm2">Idio</span> would have to download around 130 external dependencies.</li>
              <li>It's maintained by <em>Google</em> themselves by top-level software engineers who know compiler theory, so you can rely on compilation results.</li>
              <li>You don't have to compile, and simple transpilation is also possible without <em>Closure</em>.</li>
              <li>You can keep the source code of your larger packages non-compiled, but instead compile only its dependencies into a file called <em>StdLib</em>.</li>
            </ul>
            
            <p>Additionally, another reason to learn about compiler and externs, is because the highest paid Software Engineering positions are for <span class="tm2">Clojure</span> language, around $140k per year. When you're working on Clojure projects, you'll be writing your front-end in ClojureScript, that produces JavaScript compatible with <em>Closure Compiler</em>, so you'll need to understand how externs work. If you learn it via <em>NodeTools</em> today, you'll be able to become one of the highest-paid developers in the world if you decide to specialise in <em>Clojure</em> at some point.</p>
            
            
            </div>
            
            <div data-section id="web-bundling">
            <h3>Web Bundling</h3>
            
            <p><em>NodeTools</em> is a holistic package development methodology. The compiler works together with all other tools, such as Typal, that allows to maintain a single source of truth for your types and generate externs for the compiler, Documentary that can embed and interlink such type information in documentation of packages including wikis, and <em>Zoroaster</em> that provides API to test forks as well as letting you test your target compiled code, instead of only source code, which is an absolute must when taking advantage of the advanced compilation mode.</p>
            
            <p>The primary realm of our stack is Node.JS package development, however with <em>Depack</em> you can also develop and compile <a href="https://github.com/art-deco/akashic.page">web-bundles</a>, as there's also support for JSX syntax in <em>ÀLaMode</em>. It's based on regexes, but we've managed to create many nice widgets for the web with it. We'll be advertising the web stack features later on. We hope that the tools that we provide in only 10 <span class="tm">node_modules</span> folders, will really allow to have a breath of fresh air in this stale-air environment where people adapt to paradigms, instead of using such powerful language as JavaScript to their maximum advantage.</p>
            
            
            </div>
            
            <p class="SectionBreak">
              <a title="Back To Top" href="#top">
                <img alt="section break"
                  src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='13'/%3E" data-io>
                <noscript><img alt="section break" src="/nodetools/section-breaks/1.svg"></noscript></a>
            </p>
            </div>
            
          </div>
        </div>
      </div>
    </main>
    <footer class="b-ns">
      &copy; <a href="https://www.artd.eco">Art Deco™</a>, 2020
    </footer>
    <script>(function(){function b(){if(0<c.length){var a=c.shift();a.src=a.getAttribute("data-src");a.removeAttribute("data-src");a.onload=b;a.onerror=function(){console.warn("Could not load script %s",a.src)}}}var c=Array.prototype.slice.call(document.querySelectorAll("script[data-src]"));b()})()</script>
  </body>
</html>